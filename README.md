# Приложение для сбора отзывов о сети "Вкусно и точка" в Уфе

## Требования
- PostgreSQL 14
- Либо Docker

## Принцип работы
### API
- Данные собираются с помощью api 2gis и flamp. Я посмотрел, куда шлются запросы в браузере и методом проб и ошибок указал данные, с помощью которых их можно парсить.
- Ссылки на api в settings.json
- Так как ключей к этим api нет, на запросы из python они кидают ошибки авторизации.
- 2gis не позволяет собирать фирмы, поэтому я указал их в 2gis_firms.json, отзывы собираются нормально.
- Flamp позволяет собирать данные из api, если указать HTTP-заголовок authorization.

### База данных
- Отзывы собираются в базе данных
- Для сбора новых отзывов при последующих запусках в базу записываются только те отзывы, дата создания у которых больше последнего времени запуска.
- После того, как парсер завершил работу, текущее время записывается в базу

### Бот
Бот позволяет получать отзывы с определенной даты, между определенными датами и новые отзывы (которые были собраны при последнем запуске парсера)

## Запуск
### Запуск без Docker
1. Создать базу данных PostgreSQL и пользователя. Указать данные в файле env/db.env на основе db-example.env, хост указать localhost.
2. Запустить парсер с помощью ```python src/main.py```. Указать данные в файле env/app.env на основе app-example.env
3. Создать бота в телеграм с помощью BotFather.
4. Запустить бота с помощью ```python src/bot.py```. Указать данные в файле env/bot.env на основе bot-example.env

### Запуск с docker-compose
1. Создать бота в телеграм с помощью BotFather.
2. Задать данные в env-файлах src/app.env, src/bot.env, src/db.env.
3. Запустить с помощью ```docker-compose up --build```